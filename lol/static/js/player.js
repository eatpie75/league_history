(function(){var e,t,n,r,i,s;t=function(){function e(){this.page=1,this.account_id=window.account_id,this.region=window.region,this._bind()}return e.prototype._bind=function(){var e;return e=this,$(".page_link").bind("click",function(t){return e.change_page($(this))}),window.connect_items()},e.prototype.change_page=function(e){var t,n=this;return e==null&&(e=1),typeof e=="object"?t=e.data("page"):t=e,$.ajax({type:"GET",url:""+window.AJAX_BASE+"ajax/summoner_games/"+this.region+"/"+this.account_id+"/?page="+t,dataType:"html",success:function(e){return $("#games").html(e),n._bind()}})},e}(),e=function(){function e(){var e;this.column=$(".table-sort.active:first"),this.column.length>0&&(this.column_str=this.column.data("column"),this.direction=1,this.icon=this.column.children("span").children("i"),this._icons={"-1":"icon-arrow-up",1:"icon-arrow-down"},this._bind(),e=s(window.location.hash.slice(1)),"sort"in e&&("direction"in e&&(this.direction=Number(e.direction)),this.change($(".table-sort").filter(function(t){return $(this).data("column")===e.sort}).first(),!0)))}return e.prototype._bind=function(){var e;return e=this,$(".table-sort").bind("click",function(t){return e.change($(this))})},e.prototype.change=function(e,t){var n;return t==null&&(t=!1),t&&this.icon.removeClass(this._icons[1]),this.column_str===e.data("column")?(this.icon.removeClass(this._icons[""+this.direction]).addClass(this._icons[""+this.direction*-1]),this.direction*=-1):(this.column.removeClass("active"),this.icon.removeClass(this._icons[""+this.direction]),t===!1&&(this.direction=1),this.column=e,this.column_str=this.column.data("column"),this.icon=this.column.children("span").children("i"),this.column.addClass("active"),this.icon.addClass(this._icons[""+this.direction])),this.sort(e.data("column")),n=s(window.location.hash.slice(1)),n.sort=e.data("column"),this.direction===-1?n.direction=this.direction:delete n.direction,window.location.hash=$.param(n)},e.prototype.sort=function(e){var t,n=this;return t=function(t,r){var i,s,o,u,a;return o=new RegExp("(\\d+)%","i"),i=$(t).children("."+e).text(),s=$(r).children("."+e).text(),!isNaN(Number(i))&&!isNaN(Number(s))?(u=[Number(i),Number(s)],i=u[0],s=u[1],i>s?-1*n.direction:i===s?0:1*n.direction):o.test(i)&&o.test(s)?(a=[Number(i.match(o)[1]),Number(s.match(o)[1])],i=a[0],s=a[1],i>s?-1*n.direction:i===s?0:1*n.direction):i>s?1*n.direction:i===s?0:-1*n.direction},$(".cbody").append($(".cbody .sort").sort(t)),this.current_column=e},e}(),n=function(){function e(){this._bind()}return e.prototype._bind=function(){var e;return e=this,$("#stat-filter").bind("change",function(){var e,t;return e=$(this),t={},e.children("#id_game_map").val()!=="-1"&&(t.game_map=e.children("#id_game_map").val()),e.children("#id_game_mode").val()!=="-1"&&(t.game_mode=e.children("#id_game_mode").val()),window.location.search=$.param(t)})},e}(),s=function(e){var t,n,r,i,s;e=e.split("&"),r={};for(i=0,s=e.length;i<s;i++){n=e[i],t=n.split("=");if(t[0]===""&&t.length===1)break;r[decodeURI(t[0])]=decodeURI(t[1])}return r},i=function(e){var t,n=this;return t=function(){var e=this;return $.ajax({type:"GET",url:""+window.AJAX_BASE+"ajax/force_update_status/"+window.region+"/"+window.account_id+"/",dataType:"json",success:function(e){if(e.status==="QUEUE")return setTimeout(t,e.delay);if(e.status==="DONE")return $("#last-updated").text(e.msg)}})},$("#last-updated-block").html("<small id='last-updated'>WORKING...</small>"),$.ajax({type:"GET",url:""+window.AJAX_BASE+"ajax/force_update/"+window.region+"/"+window.account_id+"/",dataType:"json",success:function(e){$("#last-updated").text("LAST UPDATED:"+e.msg);if(e.status==="QUEUE")return setTimeout(t,e.delay)}})},r=function(e,t){var n,r,i,s,o;t==null&&(t="rating"),n=document.getElementById("elo-graph"),i=[];for(s=0,o=e.length;s<o;s++){r=e[s];if(r[1][t]<10)continue;i.push([new Date(r[0]),r[1][t]])}return Flotr.draw(n,[i],{xaxis:{mode:"time",showLabels:!1},yaxis:{autoscale:!0,autoscaleMargin:1,showLabels:!1},mouse:{track:!0,trackFormatter:function(e){return""+Flotr.Date.format(e.x,"%y-%m-%d")+": "+Math.round(e.y)},sensiblility:3,lineColor:"#fff",relative:!0},lines:{fill:!0,show:!0},points:{show:!0,lineWidth:1,radius:2,fillColor:"#00A8F0"},grid:{color:"#fff",verticalLines:!1,horizontalLines:!1,outline:""}})},$(document).ready(function(){window.page_handler=new t,window.champion_sort=new e,window.stat_filter=new n,$("#force-update").bind("click",i);if(window.bgchart!=null)return r(window.data,window.bgchart)})}).call(this)